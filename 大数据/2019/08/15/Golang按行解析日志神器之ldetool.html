<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Golang按行解析日志神器之ldetool | 图解我的私房菜</title>
<meta name="generator" content="Jekyll v3.8.6" />
<meta property="og:title" content="Golang按行解析日志神器之ldetool" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="ldetool 这个工具更像一个DSL，通过一种语法来写解析的语法，然后通过 ldetool generate 命令来生成 golang 代码，这个代码就是针对某中格式单行的解析方法" />
<meta property="og:description" content="ldetool 这个工具更像一个DSL，通过一种语法来写解析的语法，然后通过 ldetool generate 命令来生成 golang 代码，这个代码就是针对某中格式单行的解析方法" />
<link rel="canonical" href="/%E5%A4%A7%E6%95%B0%E6%8D%AE/2019/08/15/Golang%E6%8C%89%E8%A1%8C%E8%A7%A3%E6%9E%90%E6%97%A5%E5%BF%97%E7%A5%9E%E5%99%A8%E4%B9%8Bldetool.html" />
<meta property="og:url" content="/%E5%A4%A7%E6%95%B0%E6%8D%AE/2019/08/15/Golang%E6%8C%89%E8%A1%8C%E8%A7%A3%E6%9E%90%E6%97%A5%E5%BF%97%E7%A5%9E%E5%99%A8%E4%B9%8Bldetool.html" />
<meta property="og:site_name" content="图解我的私房菜" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-08-15T00:00:00+00:00" />
<script type="application/ld+json">
{"description":"ldetool 这个工具更像一个DSL，通过一种语法来写解析的语法，然后通过 ldetool generate 命令来生成 golang 代码，这个代码就是针对某中格式单行的解析方法","@type":"BlogPosting","url":"/%E5%A4%A7%E6%95%B0%E6%8D%AE/2019/08/15/Golang%E6%8C%89%E8%A1%8C%E8%A7%A3%E6%9E%90%E6%97%A5%E5%BF%97%E7%A5%9E%E5%99%A8%E4%B9%8Bldetool.html","headline":"Golang按行解析日志神器之ldetool","dateModified":"2019-08-15T00:00:00+00:00","datePublished":"2019-08-15T00:00:00+00:00","mainEntityOfPage":{"@type":"WebPage","@id":"/%E5%A4%A7%E6%95%B0%E6%8D%AE/2019/08/15/Golang%E6%8C%89%E8%A1%8C%E8%A7%A3%E6%9E%90%E6%97%A5%E5%BF%97%E7%A5%9E%E5%99%A8%E4%B9%8Bldetool.html"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  <meta name="HandheldFriendly" content="True" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">
  <link rel="stylesheet" href="/assets/css/main.css">
  <link rel="canonical" href="/%E5%A4%A7%E6%95%B0%E6%8D%AE/2019/08/15/Golang%E6%8C%89%E8%A1%8C%E8%A7%A3%E6%9E%90%E6%97%A5%E5%BF%97%E7%A5%9E%E5%99%A8%E4%B9%8Bldetool.html">
  <link rel="alternate" type="application/rss+xml" title="图解我的私房菜"
    href="/feed.xml">
  <link rel="stylesheet" href="/assets/css/prism.css">
  <link rel="stylesheet" href="/assets/css/prism-line-numbers.css">
  
  
  
</head>
<body class="blog">
<header class="l_header">
	<div class='wrapper'>
		<div class="nav-main container container--flex">
			<a class="logo flat-box" href="/">
				图解我的私房菜
			</a>
			
			<div class='menu'>
				<ul class='h-list'>
					
					<li>
							<a class='flat-box nav-home' href='/'>
								
								首页
							</a>
					</li>
					
					<li>
							<a class='flat-box nav-archives' href='/archives/'>
								
								时光机
							</a>
					</li>
					
				</ul>
				<div class='underline'></div>
			</div>
			

			 
			<div class="m_search">
				<form name="searchform" class="form u-search-form">
					<input type="text" id="search-input" class="input u-search-input" placeholder="Search" />
					<span class="icon icon-search"></span>
				</form>
				<ul id="results-container"> 
					</ul>
			</div>
			
		</div>

		<div class='nav-sub container container--flex' style="display: none">
			<a class="logo" class="flat-box" href='javascript:void(0)'>
				Word of Forks
			</a>
			<ul class='switcher h-list'>
				<li class='s-comment'><a href='javascript:void(0)'><span
							class="icon icon-chat_bubble_outline flat-box"></span></a></li>
				<li class='s-top'><a href='javascript:void(0)'><span class="icon icon-arrow_upward flat-box"></span></a>
				</li>
				<li class='s-toc'><a href='javascript:void(0)'><span
							class="icon icon-format_list_numbered flat-box"></span></a></li>
			</ul>
		</div>
	</div>
</header>
<aside class="menu-phone">
	<nav>
		
		
		
			<a href="/" class="nav-home nav">
				首页
			</a>
			
			
			
		
		
			<a href="/archives/" class="nav-archives nav">
				时光机
			</a>
			
			
			
	</nav>
</aside><div class="l_body">
        <div class='container clearfix'>
            <div class='l_main'>
                <article id="post-<Golang按行解析日志神器之ldetool"
  class="post white-box article-type-post"
  itemscope itemprop="blogPost">
	<section class='meta'>
	<h2 class="title"><a href="/%E5%A4%A7%E6%95%B0%E6%8D%AE/2019/08/15/Golang%E6%8C%89%E8%A1%8C%E8%A7%A3%E6%9E%90%E6%97%A5%E5%BF%97%E7%A5%9E%E5%99%A8%E4%B9%8Bldetool.html">
    	Golang按行解析日志神器之ldetool
    </a>
  </h2>
	<time>
		<span class="icon-calendar"></span> 	2019-08-15
	</time>
 
	</section>  
		<section class="toc-wrapper">
      <div class="nav">
        <span>Table Of Contents</span>
	  </div>
	   <div class="js-toc"  ></div>
	   
	</section> 
	
	<section class="article typo">
  	<div class="article-entry" itemprop="articleBody">
    	<p>为什么称为神器，<a href="https://blog.csdn.net/orangleliu/article/details/85038304">请看</a>
此文章解析日志的性能和使用方便测试</p>

<h2 id="0安装">0.安装</h2>

<pre><code class="language-bash">go get -u github.com/sirkon/ldetool
</code></pre>

<h2 id="1使用命令行如下">1.使用命令行如下</h2>

<pre><code class="language-bash">ldetool generate --package 包名 规则文件.lde
</code></pre>

<p>生成Golang规则类的文件，在Golang中调它的方法如下</p>

<pre><code class="language-go">//规则定义的类名
l := &amp;Line{}
str :="hello world"
if ok, err := l.Extract(str);ok &amp;&amp; err ==nil{
    //Time是规则定的属性
    fmt.Sprintf("%s",l.Time)
}
</code></pre>

<h2 id="2实际例子">2.实际例子</h2>

<h3 id="21日志内容">2.1日志内容</h3>

<pre><code class="language-bash">27.154.70.117 - - [20/Nov/2018:20:23:56 +0800] 2 "GET http://7img1.tianlaikge.com/tv/homeimage/201709/shengridangao.zip HTTP/1.1" 200 842186 841382 "-" "-" "Dalvik/2.1.0 (Linux; U; Android 7.1.2; vivo Y79A Build/N2G47H)" "-" 219082621 "HIT" 27.159.73.35
</code></pre>

<h3 id="22-ldetool规则文件">2.2 ldetool规则文件</h3>

<pre><code class="language-bash">vim nginx.lde
</code></pre>

<pre><code class="language-yml">Nginx =
    IP(string) " "
    ^"- - [" Time(string) ']'
    ^" "Cost(uint32)" "
    ^'"'Request(string)'"'
    ^" "Status(int64)" "
    ByteSend(int64)" "
    BodyByteSend(int64)" "
    ^'"'Referer(string)'"'
    ^" "
    ^'"'Cookie(string)'"'
    ^' '
    ^'"'UserAgent(string)'"'
    ^' '
    ^'"'Xfor(string)'"'
    ^' 'ConnID(string)' '
    ^'"'Hit(string)'"'
    ^" "
    ServerIp(string)
;
</code></pre>

<p>格式是</p>

<pre><code class="language-yml">类名=
##IP则它义定的属性，因为golang的原因，首字母要大写，如果是id则要ID都得大写
IP(string) " "
;
</code></pre>

<h2 id="3规则详解">3.规则详解</h2>

<p><img src="img/规则.png" alt="规则" title="ldetool 规则" /></p>

<h2 id="4参考文章">4.参考文章</h2>

<p><a href="https://github.com/sirkon/ldetool">官方</a></p>

  	</div><div class="page-reward">
		<a href="javascript:;" class="page-reward-btn tooltip-top">
		  <div class="tooltip tooltip-east">
		  <span class="tooltip-item">
			赏
		  </span>
		  <span class="tooltip-content">
			<span class="tooltip-text">
			  <span class="tooltip-inner">
				<p class="reward-p"><i class="icon icon-quo-left"></i>无以生计，卖文苟延<i class="icon icon-quo-right"></i></p>
				<div class="reward-box">
				  
				  <div class="reward-box-item">
					<img class="reward-img" src="/assets/img/zhifubao.png" title="支付宝扫一扫" >
					<span class="reward-type">支付宝</span>
				  </div>
				  
				  
				  <div class="reward-box-item">
					<img class="reward-img" src="/assets/img/weixin.png" title="微信扫一扫" >
					<span class="reward-type">微信</span>
				  </div>
				  
				</div>
			  </span>
			</span>
		  </span>
		</div>
		</a>
	  </div><div class="art-item-footer"><span class="art-item-left"><i class="icon icon-chevron-thin-left"></i>prev：<a href="/%E4%BA%91%E8%AE%A1%E7%AE%97/2019/07/18/docker-composer%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html"
						 rel="prev" title="玩转docker-composer基础篇" >
						 玩转docker-composer基础篇
					</a></span>
		</div></section>
	 <!--Gitalk评论start  -->
 
 <!-- Gitalk end -->

 
</article>
<script>
	window.subData = {
		title: 'Golang按行解析日志神器之ldetool',
		tools: true
	}
</script>

            </div>
            <aside class='l_side'>


<section class='m_widget time'>
    <div class='header'>当前时间</div>
    <div class='content'>
        <canvas id="canvas" style="width:100%;padding: 20px;">当前浏览器不支持canvas，请更换浏览器后再试</canvas>
    </div>
</section>


<section class='m_widget categories'>
<div class='header'>Categories</div>
<div class='content'> 
    <ul class="entry"> 
        
        <li><a class="flat-box" href="/search/categories/"><div class='name'> 云计算</div><div class='badget'>2</div></a></li>
        
        <li><a class="flat-box" href="/search/categories/"><div class='name'> 大数据</div><div class='badget'>1</div></a></li>
        
    </ul> 
</div>
</section>


<div class="m_widget tagcloud">
    <div class="header">Tags</div>
    <div class='content'>
        <div class="tags">
                
                
                
                
                
                
                



                <a href="/search/tags/docker" style="font-size: 24.0px;color: rgb(0,0,0)" >docker<span>2</span></a> <a href="/search/tags/docker-compose" style="font-size: 24.0px;color: rgb(0,0,0)" >docker-compose<span>2</span></a> <a href="/search/tags/golang" style="font-size: 12.0px;color: rgb(0,0,0)" >golang<span>1</span></a> <a href="/search/tags/" style="font-size: 12.0px;color: rgb(0,0,0)" >工具<span>1</span></a> <a href="/search/tags/" style="font-size: 12.0px;color: rgb(0,0,0)" >日志<span>1</span></a>

            
            <a href="/search/tags/docker">docker<span>2</span></a>
            
            <a href="/search/tags/docker-compose">docker-compose<span>2</span></a>
            
            <a href="/search/tags/golang">golang<span>1</span></a>
            
            <a href="/search/tags/">工具<span>1</span></a>
            
            <a href="/search/tags/">日志<span>1</span></a>
            
        </div>
    </div>
</div>
 </aside>
        </div>
    </div><footer id="footer" class="clearfix">

	<div class="social-wrapper">
  
  </div>
  
  <div>Copyright ©2011-2019 图解我的私房菜, all rights reserved.2019-08-15 00:00:00 +0000</div>

</footer>

<script src="/assets/js/jquery-1.12.4.min.js"></script> 
<script src="/assets/js/prism.js"></script>
<script src="/assets/js/topbar.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script>
    $(function() {
        function resetToDefaults() {
          topbar.config({
            autoRun      : true,
            barThickness : 3,
            barColors    : {
              '0'      : 'rgba(26,  188, 156, .9)',
              '.25'    : 'rgba(52,  152, 219, .9)',
              '.50'    : 'rgba(241, 196, 15,  .9)',
              '.75'    : 'rgba(230, 126, 34,  .9)',
              '1.0'    : 'rgba(211, 84,  0,   .9)'
            },
            shadowBlur   : 10,
            shadowColor  : 'rgba(0,   0,   0,   .6)'
          })
        }
        // Page load
        resetToDefaults()
        topbar.show()
        setTimeout(function() {
          // $('.l_body').fadeIn('slow')
          topbar.hide()
        }, 1500) 

 
    })
  </script>
  <script src="/assets/js/jquery-1.12.4.min.js"></script>
<script src="/assets/js/p/jquery.nicescroll.min.js"></script>

<script src="/assets/js/p/tocbot/tocbot.min.js"></script> 
<link rel="stylesheet" href="/assets/js/p/tocbot/tocbot.css">

<script src="/assets/js/p/backtop/backtop.js"></script> 
<link rel="stylesheet" href="/assets/js/p/backtop/back-top.css">

<script src="/assets/js/p/canvasTime.js"></script>
<script src="/assets/js/p/scrollreveal.min.js"></script>
<script src="/assets/js/p/simple-jekyll-search.min.js"></script>
<script src="/assets/js/app.js"></script>
</body>
</html>